<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Australian EV Comparison Tool</title>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #2d3748;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            overflow: hidden;
            border: 1px solid #e2e8f0;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></svg>') repeat;
            opacity: 0.1;
        }
        
        .header h1 {
            margin: 0;
            font-size: 3em;
            font-weight: 700;
            letter-spacing: -0.025em;
            position: relative;
            z-index: 1;
        }
        
        .header p {
            margin: 15px 0 0 0;
            opacity: 0.95;
            font-size: 1.2em;
            font-weight: 400;
            position: relative;
            z-index: 1;
        }
        
        .controls {
            padding: 25px 40px;
            background: linear-gradient(to right, #f8fafc, #f1f5f9);
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 14px 0 rgba(79, 70, 229, 0.39);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px 0 rgba(79, 70, 229, 0.5);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #059669, #10b981);
            box-shadow: 0 4px 14px 0 rgba(5, 150, 105, 0.39);
        }
        
        .btn-success:hover {
            box-shadow: 0 10px 25px 0 rgba(5, 150, 105, 0.5);
        }
        
        .table-container {
            padding: 40px;
            overflow-x: auto;
            background: #fafbfc;
        }
        
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            border: 1px solid #e5e7eb;
        }
        
        th {
            background: linear-gradient(135deg, #1f2937, #374151);
            color: white;
            padding: 24px 16px;
            text-align: center;
            font-weight: 700;
            font-size: 1em;
            letter-spacing: 0.025em;
            border-bottom: 3px solid #4b5563;
            position: relative;
        }
        
        th:first-child {
            width: 200px;
            position: sticky;
            left: 0;
            z-index: 10;
            text-align: left;
        }
        
        .brand-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }
        
        .brand-logo {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 18px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 2px solid #f3f4f6;
        }
        
        .tesla-logo { color: #dc2626; background: linear-gradient(135deg, #fee2e2, #fecaca); }
        .byd-logo { color: #16a34a; background: linear-gradient(135deg, #dcfce7, #bbf7d0); }
        .polestar-logo { color: #2563eb; background: linear-gradient(135deg, #dbeafe, #bfdbfe); }
        .kia-logo { color: #d97706; background: linear-gradient(135deg, #fef3c7, #fde68a); }
        
        td {
            padding: 16px;
            border-bottom: 1px solid #f1f5f9;
            font-size: 15px;
            line-height: 1.6;
            transition: all 0.2s ease;
        }
        
        td:first-child {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            font-weight: 600;
            color: #374151;
            position: sticky;
            left: 0;
            z-index: 5;
            border-right: 2px solid #e5e7eb;
            text-align: left;
        }
        
        tr:hover td {
            background: #f8fafc;
        }
        
        tr:hover td:first-child {
            background: linear-gradient(135deg, #e2e8f0, #cbd5e1);
        }
        
        .tesla-col {
            background: linear-gradient(135deg, #fef2f2, #fee2e2);
            border-left: 4px solid #ef4444;
        }
        
        .byd-col {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border-left: 4px solid #22c55e;
        }
        
        .polestar-col {
            background: linear-gradient(135deg, #eff6ff, #dbeafe);
            border-left: 4px solid #3b82f6;
        }
        
        .kia-col {
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
            border-left: 4px solid #f59e0b;
        }
        
        .price-highlight {
            font-weight: 700;
            font-size: 1.1em;
            color: #1f2937;
        }
        
        .best-value {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0) !important;
            border-left: 6px solid #10b981 !important;
            font-weight: 700;
            color: #065f46;
            position: relative;
        }
        
        .best-value::after {
            content: 'üèÜ';
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
        }
        
        .highest-value {
            background: linear-gradient(135deg, #fef3c7, #fde68a) !important;
            border-left: 6px solid #f59e0b !important;
            font-weight: 700;
            color: #92400e;
            position: relative;
        }
        
        .highest-value::after {
            content: 'üëë';
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
        }
        
        .category-header {
            background: linear-gradient(135deg, #6366f1, #8b5cf6) !important;
            color: white;
            font-size: 1.3em;
            text-align: center;
            font-weight: 700;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            border-left: none !important;
        }
        
        .summary-section {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            padding: 30px 40px;
            border-top: 2px solid #e5e7eb;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 20px;
        }
        
        .summary-card {
            background: white;
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-left: 6px solid;
            transition: transform 0.2s ease;
        }
        
        .summary-card:hover {
            transform: translateY(-2px);
        }
        
        .tesla-card { border-color: #ef4444; }
        .byd-card { border-color: #22c55e; }
        .polestar-card { border-color: #3b82f6; }
        .kia-card { border-color: #f59e0b; }
        
        .summary-card h3 {
            margin: 0 0 15px 0;
            font-size: 1.4em;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .summary-card .count {
            font-size: 2em;
            font-weight: 900;
            margin: 10px 0;
        }
        
        .summary-card .description {
            color: #6b7280;
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        .note {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2px solid #f59e0b;
            border-radius: 12px;
            padding: 20px;
            margin: 25px 0;
            color: #92400e;
            font-weight: 500;
        }
        
        .note strong {
            color: #78350f;
            font-weight: 700;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 2px solid #e5e7eb;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.2em;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            th, td {
                padding: 12px 8px;
                font-size: 13px;
            }
            
            th:first-child,
            td:first-child {
                width: 150px;
            }
            
            .brand-logo {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }
            
            .summary-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöó‚ö° Australian EV Comparison</h1>
            <p>Professional comparison of leading electric vehicles in the Australian market</p>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="downloadCSV()">
                üìä Download CSV Report
            </button>
            <button class="btn btn-success" onclick="window.print()">
                üñ®Ô∏è Print Analysis
            </button>
        </div>
        
        <div class="note">
            <strong>Professional Analysis:</strong> All pricing data is current as of June 2025 for the Australian market. 
            Specifications verified against official manufacturer sources. Drive-away pricing estimates include typical on-road costs.
        </div>
        
        <div class="table-container">
            <table id="comparison-table">
                <thead>
                    <tr>
                        <th>Specification</th>
                        <th class="tesla-col">
                            <div class="brand-header">
                                <div class="brand-logo tesla-logo">TESLA</div>
                                <div>Model Y RWD</div>
                            </div>
                        </th>
                        <th class="byd-col">
                            <div class="brand-header">
                                <div class="brand-logo byd-logo">BYD</div>
                                <div>Sealion 7 Premium</div>
                            </div>
                        </th>
                        <th class="polestar-col">
                            <div class="brand-header">
                                <div class="brand-logo polestar-logo">‚≠ê</div>
                                <div>Polestar 2 Long Range</div>
                            </div>
                        </th>
                        <th class="kia-col">
                            <div class="brand-header">
                                <div class="brand-logo kia-logo">KIA</div>
                                <div>EV5 Air Long Range</div>
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Pricing & Value -->
                    <tr>
                        <td class="category-header" colspan="5">üí∞ PRICING & VALUE</td>
                    </tr>
                    <tr>
                        <td>Starting Price (AUD, ex on-roads)</td>
                        <td class="tesla-col price-highlight">$58,900</td>
                        <td class="byd-col price-highlight best-value">$54,990</td>
                        <td class="polestar-col price-highlight">$66,400</td>
                        <td class="kia-col price-highlight">$61,170</td>
                    </tr>
                    <tr>
                        <td>Drive-Away Price (AUD)</td>
                        <td class="tesla-col price-highlight">~$65,000</td>
                        <td class="byd-col price-highlight best-value">~$60,000</td>
                        <td class="polestar-col price-highlight">~$72,000</td>
                        <td class="kia-col price-highlight">$63,990</td>
                    </tr>
                    <tr>
                        <td>Vehicle Warranty</td>
                        <td class="tesla-col">4 years / 80,000km</td>
                        <td class="byd-col">6 years / 150,000km</td>
                        <td class="polestar-col">5 years / unlimited km</td>
                        <td class="kia-col best-value">7 years / unlimited km</td>
                    </tr>
                    <tr>
                        <td>Battery Warranty</td>
                        <td class="tesla-col">8 years / 160,000km</td>
                        <td class="byd-col">8 years / 160,000km</td>
                        <td class="polestar-col">8 years / 160,000km</td>
                        <td class="kia-col">7 years / 150,000km</td>
                    </tr>
                    
                    <!-- Performance & Range -->
                    <tr>
                        <td class="category-header" colspan="5">‚ö° PERFORMANCE & RANGE</td>
                    </tr>
                    <tr>
                        <td>Body Style</td>
                        <td class="tesla-col">Mid-size SUV</td>
                        <td class="byd-col">Mid-size SUV</td>
                        <td class="polestar-col">Electric Liftback</td>
                        <td class="kia-col">Mid-size SUV</td>
                    </tr>
                    <tr>
                        <td>Drivetrain</td>
                        <td class="tesla-col">Single Motor RWD</td>
                        <td class="byd-col">Single Motor RWD</td>
                        <td class="polestar-col">Single Motor RWD</td>
                        <td class="kia-col">Single Motor FWD</td>
                    </tr>
                    <tr>
                        <td>Power Output</td>
                        <td class="tesla-col">220kW</td>
                        <td class="byd-col highest-value">230kW</td>
                        <td class="polestar-col">200kW</td>
                        <td class="kia-col">160kW</td>
                    </tr>
                    <tr>
                        <td>Torque</td>
                        <td class="tesla-col">450Nm</td>
                        <td class="byd-col">380Nm</td>
                        <td class="polestar-col highest-value">490Nm</td>
                        <td class="kia-col">310Nm</td>
                    </tr>
                    <tr>
                        <td>0-100km/h Acceleration</td>
                        <td class="tesla-col best-value">5.9 seconds</td>
                        <td class="byd-col">6.7 seconds</td>
                        <td class="polestar-col">6.4 seconds</td>
                        <td class="kia-col">~8.9 seconds</td>
                    </tr>
                    <tr>
                        <td>Top Speed</td>
                        <td class="tesla-col highest-value">217km/h</td>
                        <td class="byd-col">175km/h</td>
                        <td class="polestar-col">205km/h</td>
                        <td class="kia-col">185km/h</td>
                    </tr>
                    
                    <!-- Battery & Charging -->
                    <tr>
                        <td class="category-header" colspan="5">üîã BATTERY & CHARGING</td>
                    </tr>
                    <tr>
                        <td>Battery Capacity</td>
                        <td class="tesla-col">62.5kWh (LFP)</td>
                        <td class="byd-col">82.56kWh (LFP)</td>
                        <td class="polestar-col">82kWh (NMC)</td>
                        <td class="kia-col highest-value">88.1kWh (LFP)</td>
                    </tr>
                    <tr>
                        <td>WLTP Range</td>
                        <td class="tesla-col">466km</td>
                        <td class="byd-col">482km</td>
                        <td class="polestar-col highest-value">659km</td>
                        <td class="kia-col">555km</td>
                    </tr>
                    <tr>
                        <td>DC Fast Charging (max)</td>
                        <td class="tesla-col highest-value">175kW</td>
                        <td class="byd-col">150kW</td>
                        <td class="polestar-col">135kW</td>
                        <td class="kia-col">~150kW</td>
                    </tr>
                    <tr>
                        <td>10-80% DC Charge Time</td>
                        <td class="tesla-col best-value">~25 minutes</td>
                        <td class="byd-col">32 minutes</td>
                        <td class="polestar-col">~30 minutes</td>
                        <td class="kia-col">38 minutes</td>
                    </tr>
                    
                    <!-- Dimensions & Practicality -->
                    <tr>
                        <td class="category-header" colspan="5">üìè DIMENSIONS & PRACTICALITY</td>
                    </tr>
                    <tr>
                        <td>Length</td>
                        <td class="tesla-col">4,751mm</td>
                        <td class="byd-col highest-value">4,830mm</td>
                        <td class="polestar-col">4,606mm</td>
                        <td class="kia-col">4,615mm</td>
                    </tr>
                    <tr>
                        <td>Width</td>
                        <td class="tesla-col highest-value">2,129mm (incl. mirrors)</td>
                        <td class="byd-col">1,925mm</td>
                        <td class="polestar-col">1,985mm</td>
                        <td class="kia-col">1,875mm</td>
                    </tr>
                    <tr>
                        <td>Height</td>
                        <td class="tesla-col">1,624mm</td>
                        <td class="byd-col">1,620mm</td>
                        <td class="polestar-col">1,473mm</td>
                        <td class="kia-col highest-value">1,715mm</td>
                    </tr>
                    <tr>
                        <td>Wheelbase</td>
                        <td class="tesla-col">2,890mm</td>
                        <td class="byd-col highest-value">2,930mm</td>
                        <td class="polestar-col">2,735mm</td>
                        <td class="kia-col">2,750mm</td>
                    </tr>
                    <tr>
                        <td>Boot Space (seats up)</td>
                        <td class="tesla-col highest-value">938L</td>
                        <td class="byd-col">520L</td>
                        <td class="polestar-col">405L</td>
                        <td class="kia-col">513L</td>
                    </tr>
                    <tr>
                        <td>Boot Space (seats down)</td>
                        <td class="tesla-col highest-value">2,158L</td>
                        <td class="byd-col">1,789L</td>
                        <td class="polestar-col">1,095L</td>
                        <td class="kia-col">1,714L</td>
                    </tr>
                    <tr>
                        <td>Frunk Storage</td>
                        <td class="tesla-col highest-value">117L</td>
                        <td class="byd-col">58L</td>
                        <td class="polestar-col">41L</td>
                        <td class="kia-col">67L</td>
                    </tr>
                    <tr>
                        <td>Towing Capacity (braked)</td>
                        <td class="tesla-col highest-value">1,600kg</td>
                        <td class="byd-col">1,500kg</td>
                        <td class="polestar-col">1,500kg</td>
                        <td class="kia-col">1,500kg</td>
                    </tr>
                    
                    <!-- Technology & Features -->
                    <tr>
                        <td class="category-header" colspan="5">üì± TECHNOLOGY & FEATURES</td>
                    </tr>
                    <tr>
                        <td>Main Display</td>
                        <td class="tesla-col">15.4-inch touchscreen</td>
                        <td class="byd-col highest-value">15.6-inch rotating touchscreen</td>
                        <td class="polestar-col">11.15-inch touchscreen</td>
                        <td class="kia-col">12.3-inch touchscreen</td>
                    </tr>
                    <tr>
                        <td>Head-Up Display</td>
                        <td class="tesla-col">No</td>
                        <td class="byd-col best-value">Yes</td>
                        <td class="polestar-col">No</td>
                        <td class="kia-col">No (GT-Line only)</td>
                    </tr>
                    <tr>
                        <td>Vehicle-to-Load (V2L)</td>
                        <td class="tesla-col">No</td>
                        <td class="byd-col best-value">Yes</td>
                        <td class="polestar-col">No</td>
                        <td class="kia-col best-value">Yes</td>
                    </tr>
                    <tr>
                        <td>Panoramic Sunroof</td>
                        <td class="tesla-col">Glass roof (fixed)</td>
                        <td class="byd-col best-value">Yes (with electric blind)</td>
                        <td class="polestar-col">Glass roof (fixed)</td>
                        <td class="kia-col">Glass roof (fixed)</td>
                    </tr>
                    <tr>
                        <td>360-Degree Camera</td>
                        <td class="tesla-col">Yes</td>
                        <td class="byd-col best-value">Yes</td>
                        <td class="polestar-col">No (optional)</td>
                        <td class="kia-col">Yes</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="summary-section">
            <div class="summary-grid" id="summary-grid">
                <!-- Summary cards will be populated by JavaScript -->
            </div>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color best-value"></div>
                    <span>üèÜ Best Value / Feature Leader</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color highest-value"></div>
                    <span>üëë Highest Specification</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        function countHighlights() {
            const brands = ['tesla', 'byd', 'polestar', 'kia'];
            const counts = {};
            
            brands.forEach(brand => {
                const bestValueCells = document.querySelectorAll(`.${brand}-col.best-value`).length;
                const highestValueCells = document.querySelectorAll(`.${brand}-col.highest-value`).length;
                counts[brand] = {
                    bestValue: bestValueCells,
                    highest: highestValueCells,
                    total: bestValueCells + highestValueCells
                };
            });
            
            return counts;
        }
        
        function createSummaryCards() {
            const counts = countHighlights();
            const summaryGrid = document.getElementById('summary-grid');
            
            const brandInfo = {
                tesla: { name: 'Tesla Model Y RWD', color: '#ef4444', logo: 'TESLA' },
                byd: { name: 'BYD Sealion 7 Premium', color: '#22c55e', logo: 'BYD' },
                polestar: { name: 'Polestar 2 Long Range', color: '#3b82f6', logo: '‚≠ê' },
                kia: { name: 'Kia EV5 Air Long Range', color: '#f59e0b', logo: 'KIA' }
            };
            
            // Find the overall winner
            let winner = Object.keys(counts).reduce((a, b) => 
                counts[a].total > counts[b].total ? a : b
            );
            
            Object.keys(brandInfo).forEach(brand => {
                const card = document.createElement('div');
                card.className = `summary-card ${brand}-card`;
                
                const isWinner = brand === winner;
                const trophy = isWinner ? ' üèÜ' : '';
                
                card.innerHTML = `
                    <h3>
                        <div class="brand-logo ${brand}-logo" style="width: 40px; height: 40px; font-size: 14px;">
                            ${brandInfo[brand].logo}
                        </div>
                        ${brandInfo[brand].name}${trophy}
                    </h3>
                    <div class="count" style="color: ${brandInfo[brand].color}">
                        ${counts[brand].total}
                    </div>
                    <div class="description">
                        üèÜ Best Value: ${counts[brand].bestValue} categories<br>
                        üëë Highest Spec: ${counts[brand].highest} categories
                        ${isWinner ? '<br><strong>Overall Leader!</strong>' : ''}
                    </div>
                `;
                
                summaryGrid.appendChild(card);
            });
        }
        
        function downloadCSV() {
            const table = document.getElementById('comparison-table');
            let csv = [];
            
            // Get all rows
            const rows = table.querySelectorAll('tr');
            
            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                const cols = row.querySelectorAll('td, th');
                let csvRow = [];
                
                for (let j = 0; j < cols.length; j++) {
                    let cellData = cols[j].innerText || cols[j].textContent;
                    
                    // Clean up the data - remove emojis and extra whitespace
                    cellData = cellData.replace(/[üèÜüëëüìäüñ®Ô∏èüí∞‚ö°üîãüìèüì±üõûüõ°Ô∏èüõãÔ∏èüîß]/g, '').trim();
                    cellData = cellData.replace(/\s+/g, ' '); // Replace multiple spaces with single space
                    
                    // Escape quotes
                    cellData = cellData.replace(/"/g, '""');
                    
                    // Add quotes if cell contains comma, newline or quote
                    if (cellData.includes(',') || cellData.includes('\n') || cellData.includes('"')) {
                        cellData = '"' + cellData + '"';
                    }
                    
                    csvRow.push(cellData);
                }
                csv.push(csvRow.join(','));
            }
            
            // Add summary data
            csv.push('');
            csv.push('SUMMARY ANALYSIS');
            csv.push('Vehicle,Best Value Categories,Highest Spec Categories,Total Leading Categories');
            
            const counts = countHighlights();
            const brandNames = {
                tesla: 'Tesla Model Y RWD',
                byd: 'BYD Sealion 7 Premium', 
                polestar: 'Polestar 2 Long Range',
                kia: 'Kia EV5 Air Long Range'
            };
            
            Object.keys(counts).forEach(brand => {
                csv.push(`${brandNames[brand]},${counts[brand].bestValue},${counts[brand].highest},${counts[brand].total}`);
            });
            
            // Create blob and download
            const csvContent = csv.join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'Australian_EV_Professional_Comparison_2025.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // Initialize summary cards when page loads
        document.addEventListener('DOMContentLoaded', function() {
            createSummaryCards();
        });
    </script>
</body>
</html>
